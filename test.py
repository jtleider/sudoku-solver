import unittest
from grid import Grid

class GridTest(unittest.TestCase):

    def test_isValid_accepts_empty(self):
        grid = Grid([[0 for j in range(9)] for i in range(9)])
        self.assertTrue(grid.isValid())

    def test_isValid_finds_duplicate_row(self):
        grid = Grid([ [0 for j in range(9)] for i in range(8) ] + \
                        [ [1, 0, 0, 0, 0, 1, 2, 2, 2] ])
        self.assertFalse(grid.isValid())

    def test_isValid_finds_duplicate_col(self):
        grid = Grid([ [ [1, 0, 0, 0, 0, 0, 0, 0, 0] ] + \
                          [ [0 for j in range(9)] for i in range(7)] + \
                          [ [1, 0, 0, 0, 0, 0, 0, 0, 0] ] ])
        self.assertFalse(grid.isValid())

    def test_isValid_finds_duplicate_sgrid(self):
	grid = Grid([[1, 2, 3,  4, 5, 6,  7, 8, 9]] +
			[[2, 3, 4,  5, 6, 7,  8, 9, 0]] +
			[[3, 4, 5,  6, 7, 8,  9, 0, 1]] +
			[[4, 5, 6,  7, 8, 9,  0, 1, 2]] +
			[[5, 6, 7,  8, 9, 0,  1, 2, 3]] +
			[[6, 7, 8,  9, 0, 1,  2, 3, 4]] +
			[[7, 8, 9,  0, 1, 2,  3, 4, 5]] +
			[[8, 9, 0,  1, 2, 3,  4, 5, 6]] +
			[[9, 0, 1,  2, 3, 4,  5, 6, 7]])
	self.assertFalse(grid.isValid())
	grid = Grid([[1, 0, 0, 0, 0, 0, 0, 0, 0]] +
			[[0, 1, 0, 0, 0, 0, 0, 0, 0]] +
			[[0 for j in range(9)] for i in range(7)])
	self.assertFalse(grid.isValid())

    def test_isValid_accepts_solved(self):
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertTrue(grid.isValid())
	

    def test_isSolved(self):
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertTrue(grid.isSolved())
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertFalse(grid.isSolved())
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 9, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertFalse(grid.isSolved())

    def test_possibleValues(self):
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.possibleValues(1, 2), [8])
	grid = Grid([[0, 6, 3, 1, 0, 4, 2, 5, 8]]+
			[[1, 0, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 0, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.possibleValues(0, 1), [6, 7, 9])

    def test_setCell(self):
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	grid.setCell(0, 0, 9)
	self.assertTrue(grid.isSolved())

    def test_getCell(self):
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.getCell(8, 2), 2)
	self.assertEqual(grid.getCell(0, 0), 0)

    def test_getGrid(self):	
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.getGrid(), [[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])

    def test_findEmpty(self):
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.findEmpty(), [0, 0])
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 0, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.findEmpty(), [1, 3])
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 0, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 0, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertTrue(grid.findEmpty() == [3, 5] or grid.findEmpty() == [5, 2])
	grid = Grid([[9, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	self.assertEqual(grid.findEmpty(), None)

    def test_solve(self):
	grid = Grid([[0, 6, 3, 1, 7, 4, 2, 5, 8]]+
			[[1, 7, 8, 3, 2, 5, 6, 4, 9]] +
			[[2, 5, 4, 6, 8, 9, 7, 3, 1]] +
			[[8, 2, 1, 4, 3, 7, 5, 9, 6]] +
			[[4, 9, 6, 8, 5, 2, 3, 1, 7]] +
			[[7, 3, 5, 9, 6, 1, 8, 2, 4]] +
			[[5, 8, 9, 7, 1, 3, 4, 6, 2]] +
			[[3, 1, 7, 2, 4, 6, 9, 8, 5]] +
			[[6, 4, 2, 5, 9, 8, 1, 7, 3]])
	grid.solve()
	self.assertEqual(grid.getCell(0, 0), 9)
	grid = Grid([[0, 7, 2, 5, 4, 9, 6, 8, 3]]+
			[[6, 4, 5, 8, 7, 3, 2, 1, 9]] +
			[[3, 0, 9, 2, 6, 1, 7, 4, 5]] +
			[[4, 9, 6, 3, 2, 7, 8, 5, 1]] +
			[[8, 1, 3, 4, 5, 6, 9, 7, 2]] +
			[[2, 5, 7, 1, 9, 8, 4, 3, 6]] +
			[[9, 6, 4, 7, 1, 5, 3, 2, 8]] +
			[[7, 3, 1, 6, 8, 2, 0, 9, 4]] +
			[[5, 2, 8, 9, 3, 4, 1, 6, 0]])
	grid.solve()
	self.assertEqual(grid.getCell(0, 0), 1)
	self.assertEqual(grid.getCell(8, 8), 7)
	self.assertEqual(grid.getCell(7, 6), 5)
	self.assertEqual(grid.getCell(2, 1), 8)
	self.assertEqual(grid.getCell(0, 2), 2)
	self.assertEqual(grid.grid, [[1, 7, 2, 5, 4, 9, 6, 8, 3]]+
			[[6, 4, 5, 8, 7, 3, 2, 1, 9]] +
			[[3, 8, 9, 2, 6, 1, 7, 4, 5]] +
			[[4, 9, 6, 3, 2, 7, 8, 5, 1]] +
			[[8, 1, 3, 4, 5, 6, 9, 7, 2]] +
			[[2, 5, 7, 1, 9, 8, 4, 3, 6]] +
			[[9, 6, 4, 7, 1, 5, 3, 2, 8]] +
			[[7, 3, 1, 6, 8, 2, 5, 9, 4]] +
			[[5, 2, 8, 9, 3, 4, 1, 6, 7]])
	
if __name__ == '__main__':
    unittest.main()
